---
- name: Time to install and configure Ansible Automation Platform
  hosts: control
  gather_facts: no

  tasks:
       
    - name: Get the Ansible Bundle
      ansible.builtin.get_url:
        url: https://developers.redhat.com/content-gateway/file/ansible/Ansible_Automation_Platform_2.4/ansible-automation-platform-setup-bundle-2.4-1-x86_64.tar.gz
        dest: /root/ansible-automation-platform-setup-bundle-2.4-1-x86_64.tar.gz
        mode: '0755'
        username: "{{ username }}"
        password: "{{ password }}"

    - name: Ensure unzip is installed
      ansible.builtin.dnf:
        name: unzip
        state: present

    - name: Untar and unzip the ansible bundle
      ansible.builtin.unarchive:
        src: /root/ansible-automation-platform-setup-bundle-2.4-1-x86_64.tar.gz
        dest: /root/
        remote_src: true